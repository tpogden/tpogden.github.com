<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2019-12-31">

<title>Thomas Ogden - Book Notes, 2019</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script data-goatcounter="https://ogden.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Thomas Ogden</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title display-7">Book Notes, 2019</h1>

<p class="date">2019-12-31</p>
</header>

<ol type="1">
<li><p><em>Sapiens</em> by Yuval Noah Harari — A wide-lens look at human history, particularly at biology and culture. One of the most interesting arguments is that the agricultural revolution promoted huge population growth, and was thus successful for the species, but made the lives of individual <em>homo sapiens</em> worse than when they had been hunter gatherers. The same claim may be made for the industrial revolution. Once such an upheaval has happened there’s no way back.</p></li>
<li><p><em>Rolling Blackouts</em> by Sarah Glidden — Two youngish American journalists tour Turkey, Syria and Iraq, looking for stories. Glidden, the author and cartoonist of this graphic novel, tags along to document the trip. So does another friend, a former US marine who served in Iraq and has his own view on things. It’s poignant to read the stories of Iraqi families who found refuge in Syria, realising that in the time since this was written their lives have no doubt been in danger and turmoil all over again.</p></li>
<li><p><em>Silence</em> by Erling Kagge — Not a deep read, but reminded me that one of the great benefits of long distance running or walking is spending time in your own head.</p></li>
<li><p><em>Everything and More</em> by David Foster Wallace — A history of infinity, in particular the work of Georg Cantor. Wallace tries to cut down on the amount of repetition in mathematical writing with a lot of abbreviations, but I found this slowed down the reading rather than help. The book claims to be readable without some background in maths. As in the case of Penrose’s <em>The Road to Reality</em> I think even if that were true it would not be a fun read. If you’ve studied some mathematical foundations, I recommend.</p></li>
<li><p><em>Seveneves</em> by Neal Stephenson — I’ve long thought if I ever got into sci-fi, I’d get into it hard. This might be the book to do it. Saying that, the first two of the three parts are the ones I really enjoyed and they’re the ones that are set in the near future with some nice thinking about orbital mechanics. The third part, the real sci-fi bit, took a while for me to see the point of.</p></li>
<li><p><em>Janesville</em> by Amy Goldstein ★ — The modern history of one industrial city in Wisconsin. Janesville was the home of the Parker pen company and had the oldest General Motors factory in the US until it closed in 2008. The book follows a few of the residents affected by the plant closure over the following five years. These characters make concrete the problems of deindustrialisation: how tough it to lose the job you thought would be for life, how tough it is to retrain, to commute huge distances or move when property prices plummet.</p></li>
<li><p><em>12 Rules for Life</em> by Jordan B. Peterson — Like any self-help book, there’s some obvious stuff here that could be useful. Useful to me maybe. “Treat yourself like someone you are responsible for helping”, sure. Society is full of Pareto distributions, sure. Be ready for a lot of Old Testament. Among the weirdness, there’s a bit where his example of good parenting is his ability to pin down a two year old.</p></li>
<li><p><em>Daniels’ Running Formula</em> by Jack Daniels — Training plans from 800m to marathon with useful details on physiology, nutrition and recovering from injuries. The latter became the most important chapter this time as I got crocked halfway through a marathon programme.</p></li>
<li><p><em>October</em> by China Miéville — A narrative look at the Russian Revolution between February and October 1917. There’s a lot of bureaucracy that is key to the story (so many committees) and it’s hard to make that interesting even for a storyteller like Miéville. His own politics must be considered, including admiration of Lenin, but he’s open about it.</p></li>
<li><p><em>Aurora</em> by Melanie Windridge — This is a combination of a travelogue around Canada, Iceland, Scotland, Sweden, Norway (northern parts of the world where the auroral oval can be seen) and a pop science explainer. Windridge is a plasma physicist and does the explaining well. I thought I roughly understood the mechanism: solar wind hits magnetosphere, solar wind particles excited. I was close but wrong.</p>
<p>Here’s how I understand it after reading the book. Solar wind is plasma with a frozen-in magnetic field. The direction of the field can be pointing north or south as the sun spins and blasts out coronal mass ejections. When the solar wind hits the magnetosphere, the plasma is diverted around the Earth, and its frozen-in magnetic field is draped around the magnetosphere. There’s a clustering of field lines on the upstream (sun-side) of Earth, 60,000 km above the equator. If fields pointing in opposite directions are pushed close enough together, the field plasma can break down and the magnetic configuration can change: field lines break and reconnect. There’s tension in the plasma, and the reconnection catapults plasma particles away and down the field lines. Energy is transferred from the field to the particles as they are accelerated to high speed. The particles collide with the upper atmosphere and its the atmospheric particles that are excited. So the aurora happens at the bottom of the field lines.</p>
<p>I also learnt which transitions cause the different colours of the aurora and why they’re banded by height. Greens and reds are both transitions of oxygen. The decay lifetime of the green excitation is around a second, the red excitation lifetime is about two minutes. If there’s a collision with another molecule before the excited molecule has time to decay, the energy will be lost as heat and there won’t be colour emission. So the green transition is more common than the red. Also the red aurora tends to appear above 200 km (where there are fewer molecules to bump into) and the green aurora are lower at around 150 km. Pink and purple colours are due to transitions of nitrogen that have much shorter decay times and can be seen below 100 km.</p></li>
<li><p><em>A Small Town in Germany</em> by John le Carré — I’ve been meaning to try a le Carré book for a while, and was immediately hooked on this one. Something between a spy novel and a mystery set in Bonn in the 60s.</p></li>
<li><p><em>So Good They Can’t Ignore You</em> by Cal Newport ★ — ‘Follow your passion’ is terrible advice.</p></li>
<li><p><em>Empire</em> by Stephen Howe — Howe splits empires into those on land and those of sea. Land empires being those that grew by overland expansion, extending frontiers, like the Roman or the Ottoman. We maybe don’t even think of the ones that still exist as being empires, like the Russian, Chinese or American. The sea power empires are the European kind of the last 500 years, the ones that really spread over the globe. The book mostly focusses on these, the impact and aftermath of that imperialism.</p>
<blockquote class="blockquote">
<p>The economic balance sheet of colonialism, for both imperialist and colonized countries, presents a hugely complex, mixed record: one over which economic historians have long disputed, and will continue to do so. […] In some, indeed, all the preconditions for future commercial and industrial dynamism were present, as in India with its huge production of textiles. Colonial rule destroyed these conditions where they existed, and blocked the possibility of their emerging elsewhere. Colonized areas were forced into acting as sources of underpriced raw materials for European industry and of cheap, often forced or enslaved, labour. They were not allowed to develop industries of their own, except in the few cases where this suited European needs.</p>
</blockquote></li>
<li><p><em>How to Be Miserable</em> by Randy J. Paterson — I picked this up after watching <a href="https://www.youtube.com/watch?v=LO1mTELoj6o">CGP Grey’s short video</a>, which I bet sold a lot of copies. Here’s Grey:</p>
<blockquote class="blockquote">
<p>Aim toward the mirage of happiness rather than improving the ship upon which you sail. Last, but most important, follow your instincts. Navigation deeper into the sea of sadness is quite easy, for there is a dark magnetic field that points the compass of your impulses in the right direction once you get started. You will want to stay indoors, you will want to not exercise, you will want to sleep in, you will want to do what you know will make you sadder after you’ve done it.</p>
</blockquote></li>
<li><p><em>The Bridge</em> by Geert Mak — The fifth, current, <a href="https://en.wikipedia.org/wiki/Galata_Bridge">Galata Bridge</a> is not architecturally interesting but its location and history are remarkable. And the memory of <a href="../istanbul-apr-2012">walking over it</a> has stuck with me: a city of its own with its fishermen, street sellers, pickpockets and hustlers.</p>
<p>Orhan Pamuk writes of the bridge in <em>The Museum of Innocence</em> but I wondered who else had. The reason this book is a great read is that Mak spent the time to get the stories of the characters who make the bridge home and passes these stories on with empathy.</p></li>
<li><p><em>Why I’m No Longer Talking to White People About Race</em> by Reni Eddo-Lodge {% include dash.html %} Eddo-Lodge <a href="https://www.theguardian.com/world/2017/may/30/why-im-no-longer-talking-to-white-people-about-race">says the title of this book comes from</a></p>
<blockquote class="blockquote">
<p>The gulf of an emotional disconnect that white people display when a person of colour articulates their experience. You can see their eyes shut down and harden. It’s like treacle is poured into their ears, blocking up their ear canals. It’s like they can no longer hear us.</p>
</blockquote>
<p>There were plenty of times reading the book I felt that disconnect, felt the awkwardness of having to think about how that experience differs from mine. I spend close to zero time thinking about what it means to be white. Recommended.</p></li>
<li><p><em>Call for the Dead</em> by John Le Carré — After <em>A Small Town in Germany</em> I went back to the first of the Smiley novels.</p></li>
<li><p><em>A Murder of Quality</em> by John Le Carré — The second Smiley novel is a murder thriller.</p></li>
<li><p><em>The Spy Who Came In from the Cold</em> by John Le Carré — The third Smiley novel is back to espionage and to East Germany. OK, this one is really great.</p></li>
<li><p><em>The Mixer</em> by Michael Cox — A history of the Premier League in tactics, this starts by emphasising how much the back pass rule changed football. It stopped teams (notably Liverpool) using the back pass to kill games off when ahead. Defenders had to improve technically and goalkeepers had to become footballers. More exciting, especially on television.</p>
<p>Cantona changes forward play, after which every team wants a foreign, mercurial number 10. Most are forgettable but then there’s Zola and Bergkamp. Arsené Wenger arrives, asking his chairman if fans would tolerate two foreign players in the team. Then the sprinter-finishers, Owen and Anelka. Reacting, clubs now need defenders to be fast too. Vialli lines up a Chelsea team with no British players.</p>
<p>English tactics still lag European leagues, but Alex Ferguson picks it up as United get better in the Champions league. He not only built different champion teams but also derived at least three entirely different strategies to get ahead of the league. Arsené built the Invincibles. Later, Mourinho and Benitez, similar in background and in their reactive play, study hours of video and adapt each game to target opponents’ weaknesses. Their introduction in the same season lowered scoring rates in the league. Then possession football, false nines, inverted wingers and assisters. Finally the pressers, Pochettino and Klopp. Defenders had to attack, now attackers have to defend.</p>
<p>Football is never still. As soon as a winning strategy emerges, counterstrategies arrive to beat it. They usually arrive from abroad. I read this during the World Cup. The combination might be enough to get me interested in football again after years of only paying attention to the Reds.</p></li>
<li><p><em>Enlightenment Now</em> by Steven Pinker — The world is getting worse. Things were better in the past. The current order is broken and corrupt. A revolution is required. If people are hurt in that revolution, it’s for the greater ideological good. Facts are not facts. Wading through the daily swamp of Brexit, Trumpism and Corbynism, modern populism can sound a lot like apocalyptic religion.</p>
<p>Pinker makes a restatement of the case for the Enlightenment values of reason, science and humanism. In the first part he takes measures of human wellbeing (health, wealth, safety, the environment, peace, equal rights, etc.) a chapter at a time and looks at long term positive trends. Where I do not follow Pinker’s optimism is climate change. He doesn’t look closely enough at how and why the opportunity to decarbonise energy early was missed. The result is already disastrous and may well be catastrophic.</p></li>
<li><p><em>The Looking Glass War</em> by John Le Carré — Up to the fourth Smiley novel now. Le Carre’s world of Cold War espionage is dark, messy and psychological. His spies are not just fallible but self-interested and often mediocre. Good plot.</p></li>
<li><p><em>Hackers and Painters</em> by Paul Graham — Graham is the co-founder of <a href="https://www.ycombinator.com">Y Combinator</a>. This collection of essays are from his blog so I’ve read some of them before. Some interesting examples are <a href="http://www.paulgraham.com/nerds.html">Why Nerds are Unpopular</a>, <a href="http://www.paulgraham.com/hundred.html">The Hundred Year Language</a> and <a href="http://www.paulgraham.com/wealth.html">How to Make Wealth</a>. The writing is good and editing tight, but they’re mostly humourless. The ones on programming langauges are best. For a rebuttal to <a href="http://www.paulgraham.com/hp.html">the title essay</a>, see that other programmer, painter and solid writer <a href="https://idlewords.com/2005/04/dabblers_and_blowhards.htm">Maciej Cegłowski</a>.</p></li>
<li><p><em>Triumph of the City</em> by Edward L. Glaeser ★ — I’ve lived most of my adult life in the centre of cities, not by accident. Harvard urban economist Edward Glaeser here makes the case for urban life. First, on the agglomeration effects that have made cities hubs of productivity through history.</p>
<blockquote class="blockquote">
<p>Silicon Valley and Bangalore remind us that electronic interaction won’t make fact-to-face contact obsolete. The computer industry, more than any other sector, is the place where one might expect remote communication to replace person-to-person meetings.</p>
</blockquote>
<p>There’s a chapter that looks at the decline of industrial cities, with an interesting observation on what made those cities vulnerable.</p>
<blockquote class="blockquote">
<p>The industrial town was unlike either those old commercial cities or the modern capitals of the information age. Its vast factories employed hundreds of thousands of relatively unskilled workers. Those factories were self-sufficient and isolated from the world outside, except that they were providing the planet with vast quantities of cheap, identical products.</p>
</blockquote>
<p>Some cities have tried to build themselves back to success, which Glaeser argues is getting things the wrong way around. In fact, bulldozing might be a better, if unpopular, strategy.</p>
<blockquote class="blockquote">
<p>Leipzig is worthy of emulation less for its cultural strategy than for its hard headed policy of accepting decline and reducing the empty housing stock. In 2000, one fifth of the city’s homes stock was vacant, a total of 62,500 homes. Bulldozing vacant homes reduces the cost of city services, eliminates safety hazards, and turns decaying eyesores into usable space. Leipzig set a target of destroying 20,000 vacant units.</p>
</blockquote>
<p>The visibility of poverty in cities can give people the idea cities <em>cause</em> poverty but this is <a href="https://calhounpress.net/blogs/blog/78070918-wet-streets-cause-rain-michael-crichton-on-the-gell-mann-amnesia-effect">wet streets cause rain</a> thinking.</p>
<blockquote class="blockquote">
<p>Cities can be places of great inequality; they attract some of the world’s richest and poorest people. Although poverty can accompany urban decline, poverty often shows that a city is functioning well. Cities attract poor people because they’re good places for poor people to live.</p>
</blockquote>
<p>Maybe we should be more concerned about the cities where we don’t see poverty.</p>
<blockquote class="blockquote">
<p>The absence of poor people in an area is a signal that it lacks something important, like affordable housing or public transportation or jobs for the least skilled.</p>
</blockquote>
<p>Living in a city is far better for the environment than living in the countryside. I’ve learnt that people are surprised when you tell them this and can get offended if they have moved out to a shire and think they’re saving the planet because they drive once a month to an organic farmers’ market in a diesel.</p>
<p>What makes a succesful city? The book concludes with the standout example of Singapore, which provides a high quality of life and plenty of wealth for its citizens without having much in the way of natural resources. The drivers are a remarkably competent public sector and decades-long focus on education.</p>
<blockquote class="blockquote">
<p>Education is, after January temperature, the most reliable predictor of urban growth.</p>
</blockquote></li>
<li><p><em>Energy</em> by Richard Rhodes — An ambitious and detailed trip through 400 years of human energy production from wood burning through coal, oil, petrol, nuclear and renewable energy sources, looking at innovation and the impact on society and the environment.</p>
<p>There are some great historical notes. I thought I knew well the story of Stephenson’s first passenger railway from here in Manchester to Liverpool, but there is good detail on the ingenuity of floating the tracks over the swamp of Chat Moss and the invested interests Stephenson fought, from canal owners, carriage companies and wealthy landowners. The Earl of Sefton sent secret death threats, letting Stephenson know he’d have him thrown in a lake if he persisted in taking the railway through Sefton’s estates.</p></li>
<li><p><em>A Walk in the Woods</em> by Bill Bryson — I read a bunch of Bryson’s travel books <a href="../bookshelf/2015">in 2015</a> but put this one off partly because I knew it’d just put in my head the idea of walking the Appalachian Trail and that’s not a small thing to have in your head. It’s about 3,500 km long, it’d take months. Anyway, now I want to walk the Appalachian Trail.</p></li>
<li><p><em>Worth Dying For</em> by Tim Marshall — A world tour of national flags, and some others. There’s a bit of history on each and some interesting facts, like the eight places the Stars and Stripes is authorised to fly 24 hours a day, how Nato HQ rotates its flags every Sunday, and that the night sky shown in the Brazil flag is just as it would have been observed in Rio de Janeiro on 15 November 1889 at the time the monarchy was taken down.</p>
<p>There’s brief mentions of how flags are used to unite and divide, including how the St George’s Cross gets co-opted by the far right in Britain and why the Confederate flag is still flown in the Southern US. But mostly it’s an interesting light read.</p>
<p>Favourite flags? <a href="https://en.wikipedia.org/wiki/Flag_of_South_Korea">South Korea</a>, <a href="https://en.wikipedia.org/wiki/Flag_of_Barbados">Barbados</a>, <a href="https://en.wikipedia.org/wiki/Flag_of_Seychelles">Seychelles</a>, <a href="https://en.wikipedia.org/wiki/Flag_of_Brazil">Brazil</a>, <a href="https://en.wikipedia.org/wiki/Flag_of_Vietnam">Vietnam</a>. And <a href="https://en.wikipedia.org/wiki/Flag_of_Nepal">Nepal</a> because yeah, enough rectangles.</p></li>
<li><p><em>Madness Visible</em> by Janine di Giovanni ★ — I made trips to Slovenia and Croatia this year, both beautiful, modern EU states. I picked this up in a bookshop in Dubrovnik: Di Giovanni’s memoir of the Balkan Wars, which she covered on the ground for <em>The Times</em>. It’s a harrowing firsthand account of the devestating reality of murder, torture and ethnic cleansing from Sarajevo, Kosovo, Pristina. Di Giovanni avoids political judgements, focusing on reporting war from the perspective of its victims.</p>
<p>It’s a reminder of the extreme danger faced by war correspondents. Subscribe to a newspaper that pays foreign correspondents or there’ll be nobody there to report on such atrocities.</p></li>
</ol>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right"><em>Think deeply of simple things.</em></div>
  </div>
</footer>



</body></html>